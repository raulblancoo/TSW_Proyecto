<!-- fragments/form-fields.html -->
<div th:fragment="formFields">
    <form th:action="@{/groups/create}" method="post" th:object="${group}">
        <div class="mb-4">
            <label class="block text-sm font-medium mb-2" for="group-name">Group name</label>
            <input class="w-full p-3 bg-gray-700 rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
                   id="group-name" name="groupName" placeholder="Enter a group name" type="text" field="*{groupName}" required/>
        </div>
        <p class="text-xs text-gray-400 mb-4">You can change this later</p>
        <div class="mb-4">
            <label class="block text-sm font-medium mb-2" for="email">Add email</label>
            <input class="w-full p-3 bg-gray-700 rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
                   id="email" placeholder="Enter an email address" type="email"/>
            <button type="button" id="add-email-btn" class="mt-2 bg-blue-500 text-white p-2 rounded">Add Email</button>
            <p class="text-xs text-gray-400 mt-2">The email will be added to the group</p>
        </div>
        <!-- Campo oculto para almacenar los emails como una lista -->
        <input type="hidden" id="emails" name="emails" field="*{emails}"/>
        <!-- Lista de emails añadidos -->
        <ul id="email-list" class="mb-4 text-white"></ul>

        <div th:replace="~{groups/currency-selector :: currencySelector}"></div>

        <button type="submit" class="bg-blue-500 text-white p-3 rounded">Save</button>
    </form>

    <script>
        document.getElementById('add-email-btn').addEventListener('click', function() {
            const emailInput = document.getElementById('email');
            const emailValue = emailInput.value;
            const emailList = document.getElementById('email-list');
            const emailsField = document.getElementById('emails');

            // Validar que el campo de email no esté vacío
            if (emailValue) {
                // Crear un nuevo elemento <li> para mostrar el email en la lista
                const li = document.createElement('li');
                li.textContent = emailValue;
                emailList.appendChild(li);

                // Actualizar el campo oculto con los emails (separados por comas)
                let emailsArray = emailsField.value ? emailsField.value.split(',') : [];
                emailsArray.push(emailValue);
                emailsField.value = emailsArray.join(',');

                // Limpiar el campo de entrada después de añadir el email
                emailInput.value = '';
            } else {
                alert('Please enter a valid email address.');
            }
        });
    </script>
</div>
